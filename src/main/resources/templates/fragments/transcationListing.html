<!DOCTYPE html> <html lang="en" xmlns:th="http://www.thymeleaf.org"> <head> <meta http-equiv="X-UA-Compatible" content="IE=edge" /> <title>KushalKart Admin</title> <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" /> <link rel="icon" href="/admin-ui/img/kaiadmin/favicon.ico" type="image/x-icon" /> <!-- Fonts and icons --> <script src="/admin-ui/js/plugin/webfont/webfont.min.js"></script> <script> WebFont.load({ google: { families: ["Public Sans:300,400,500,600,700"] }, custom: { families: ["Font Awesome 5 Solid","Font Awesome 5 Regular","Font Awesome 5 Brands","simple-line-icons"], urls: ["/admin-ui/css/fonts.min.css"], }, active: function () { sessionStorage.fonts = true; }, }); </script> <!-- CSS Files --> <link rel="stylesheet" href="/admin-ui/css/bootstrap.min.css" /> <link rel="stylesheet" href="/admin-ui/css/plugins.min.css" /> <link rel="stylesheet" href="/admin-ui/css/kaiadmin.min.css" /> <link rel="stylesheet" href="/admin-ui/css/demo.css" /> </head> <body> <div class="wrapper"> <div th:replace="fragments/sidebar :: sidebar"></div> <div class="main-panel"> <div class="main-header"> <div class="main-header-logo"> <div class="logo-header" data-background-color="dark"> <a href="/" class="logo"> <img src="/admin-ui/img/kaiadmin/kushalkart.png" alt="Logo" height="20" /> </a> <button class="btn btn-toggle toggle-sidebar"><i class="gg-menu-right"></i></button> </div> </div> <div th:replace="fragments/navbar :: navbar"></div> </div>
  <div class="container">
  <div class="page-inner">
    <div class="d-flex align-items-left align-items-md-center flex-column flex-md-row pt-2 pb-4">
      <div>
        <h3 class="fw-bold mb-3">Transaction History</h3>
        <h6 class="op-7 mb-2">Filter and review transactions</h6>
      </div>
    </div>

    <!-- Filters -->
    <div class="row mb-3">
      <div class="col-md-2">
        <input type="number" id="userId" class="form-control" placeholder="User ID" />
      </div>
      <div class="col-md-2">
        <input type="number" id="transactionStatusId" class="form-control" placeholder="Status ID" />
      </div>
      <div class="col-md-2">
        <input type="number" step="0.01" id="amountMin" class="form-control" placeholder="Min Amount" />
      </div>
      <div class="col-md-2">
        <input type="datetime-local" id="from" class="form-control" placeholder="From" />
      </div>
      <div class="col-md-2">
        <input type="datetime-local" id="to" class="form-control" placeholder="To" />
      </div>
      <div class="col-md-2">
        <input type="text" id="reference" class="form-control" placeholder="Reference" />
      </div>
      <div class="col-md-2 mt-2">
        <button class="btn btn-primary w-100" id="applyFilters">Apply</button>
      </div>
    </div>

    <!-- Transactions Table -->
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead class="thead-light">
          <tr>
            <th>ID</th>
            <th>User</th>
            <th>Booking</th>
            <th>Balance Type</th>
            <th>Txn Type</th>
            <th>Payment Type</th>
            <th>Amount</th>
            <th>Remarks</th>
            <th>Reference</th>
            <th>Status</th>
            <th>Created At</th>
          </tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="d-flex align-items-center gap-2 mt-3">
      <button class="btn btn-secondary" id="prev">Prev</button>
      <span id="pageInfo" class="mx-2"></span>
      <button class="btn btn-secondary" id="next">Next</button>
    </div>
  </div>
</div>

<div th:replace="fragments/footer :: footer"></div>

</div> </div> <!-- Scripts --> <script src="/admin-ui/js/core/jquery-3.7.1.min.js"></script> <script src="/admin-ui/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script> <script src="/admin-ui/js/core/popper.min.js"></script> <script src="/admin-ui/js/core/bootstrap.min.js"></script> <script src="/admin-ui/js/kaiadmin.min.js"></script> <script src="/admin-ui/js/auth.js"></script> <script> const rows = document.getElementById('rows'); const pageInfo = document.getElementById('pageInfo'); const userIdEl = document.getElementById('userId'); const statusEl = document.getElementById('transactionStatusId'); const amountMinEl = document.getElementById('amountMin'); const fromEl = document.getElementById('from'); const toEl = document.getElementById('to'); const referenceEl = document.getElementById('reference'); let page = 0, size = 20, last = false; async function fetchTransactions() { const params = new URLSearchParams(); params.set('page', page); params.set('size', size); if (userIdEl.value) params.set('userId', userIdEl.value); if (statusEl.value) params.set('transactionStatusId', statusEl.value); if (amountMinEl.value) params.set('amountMin', amountMinEl.value); if (fromEl.value) params.set('from', fromEl.value); if (toEl.value) params.set('to', toEl.value); if (referenceEl.value) params.set('reference', referenceEl.value); const res = await authFetch(`/admin/transactions?${params}`, { method: 'GET' }); if (!res) return; const json = await res.json(); const data = json.data.content; rows.innerHTML = ''; data.forEach(t => { const tr = document.createElement('tr'); tr.innerHTML = ` <td>${t.id}</td> <td>${t.userName} (${t.userId})</td> <td>${t.bookingId || ''}</td> <td>${t.balanceTypeName || ''}</td> <td>${t.transactionTypeName || ''}</td> <td>${t.paymentTypeName || ''}</td> <td>${t.amount}</td> <td>${t.remarks || ''}</td> <td>${t.transactionReference || ''}</td> <td>${t.transactionStatusName || ''}</td> <td>${t.createdAt.replace('T', ' ')}</td> `; rows.appendChild(tr); }); const pageData = json.data; const current = pageData.number + 1; const totalPages = pageData.totalPages; const total = pageData.totalElements; pageInfo.textContent = `Page ${current} of ${totalPages} - ${total} records`; last = pageData.last; } document.getElementById('applyFilters').onclick = () => { page = 0; fetchTransactions(); }; document.getElementById('prev').onclick = () => { if (page>0) { page--; fetchTransactions(); } }; document.getElementById('next').onclick = () => { if (!last) { page++; fetchTransactions(); } }; // initial load fetchTransactions(); </script> </body> </html>